---

## ğŸ”” **OpenShift Build Triggers Overview**

Build triggers in OpenShift automatically start builds when certain events occur.
They enable **continuous integration and delivery** without manual build execution.

---

### âš™ï¸ Types of Build Triggers

| Trigger Type                           | Purpose                                                  |
| -------------------------------------- | -------------------------------------------------------- |
| **Webhook Trigger**                    | Start build when Git repo receives a new push or PR      |
| **Image Change Trigger (ICT)**         | Start build when the builder image or base image changes |
| **Configuration Change Trigger (CCT)** | Start build when the BuildConfig itself is updated       |

Multiple triggers can be combined in a single **BuildConfig**.

---

## ğŸª 1. Webhook Trigger

The webhook trigger starts a build when a remote system (GitHub, GitLab, Bitbucket, CI tools, etc.) sends a POST request to a webhook URL generated by OpenShift.

### ğŸ”¹ Use case

* CI/CD triggered by **Git push**
* Automated builds for **pull requests**

### ğŸ”¹ Enabling Webhook Trigger in BuildConfig

```yaml
triggers:
  - type: GitHub
    github:
      secret: my-secret
  - type: Generic
    generic:
      secret: my-secret2
```

### ğŸ”— Getting Webhook URL

```bash
oc describe bc <buildconfig-name>
```

OpenShift will show URLs like:

```
Webhook GitHub URL:  https://<openshift>/apis/build.openshift.io/...&secret=<secret>
Webhook Generic URL: https://<openshift>/apis/build.openshift.io/...&secret=<secret2>
```

When a POST request hits this URL â†’ **Build starts automatically**

---

## ğŸ–¼ï¸ 2. Image Change Trigger (ICT)

ICT triggers a new build whenever the **input builder/base image changes**, such as:

* New S2I image version
* Updated runtime image
* Buildah/Docker base image updated

### ğŸ”¹ Use case

* Rebuild app automatically when **Java base image updates**
* Rebuild NodeJS app when **security patched base images** arrive

### ğŸ”¹ Enabling ICT

```yaml
triggers:
  - type: ImageChange
    imageChange:
      from:
        kind: ImageStreamTag
        name: nodejs:latest
```

### ğŸ” Flow

```
ImageStream new tag â†’ ICT fires â†’ OpenShift starts build â†’ new application image generated
```

---

## ğŸ”„ 3. Configuration Change Trigger (CCT)

A Configuration Change Trigger starts a build whenever the **BuildConfig resource itself updates**.

### ğŸ”¹ Use case

* New branch or repo URL configured
* Updated build environment variables
* Changed build arguments or strategy

### ğŸ”¹ Enabling CCT

```yaml
triggers:
  - type: ConfigChange
```

Every time you modify the BuildConfig and apply it:

```bash
oc apply -f buildconfig.yaml
```

â†’ A new build starts.

---

## ğŸ§© Combined Example (Recommended)

```yaml
apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  name: nodejs-build
spec:
  source:
    git:
      uri: https://github.com/example/nodejs-app.git
  strategy:
    type: Source
    sourceStrategy:
      from:
        kind: ImageStreamTag
        name: nodejs:14
  triggers:
    - type: GitHub
      github:
        secret: github-secret
    - type: ImageChange
    - type: ConfigChange
```

This creates:

| Event                     | Result              |
| ------------------------- | ------------------- |
| Commit pushed to GitHub   | New build triggered |
| NodeJS base image updated | New build triggered |
| BuildConfig updated       | New build triggered |

---

## ğŸ“Œ Commands for Manually Triggering Builds

| Action                   | Command               |
| ------------------------ | --------------------- |
| Trigger a build          | `oc start-build <bc>` |
| Follow logs during build | `oc logs -f bc/<bc>`  |
| List all builds          | `oc get builds`       |

---

## ğŸ Summary

| Trigger                        | Based On                   | Ideal Use Case                      |
| ------------------------------ | -------------------------- | ----------------------------------- |
| **Webhook**                    | Git events                 | Continuous Integration              |
| **Image Change (ICT)**         | Updated base/builder image | Security and framework updates      |
| **Configuration Change (CCT)** | BuildConfig change         | Version upgrades or build arguments |

---

