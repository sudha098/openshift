# ğŸ–¼ï¸ Image Streams Overview (OpenShift)

An **ImageStream** in OpenShift is an abstraction layer on top of container images.
It acts as a **pointer to one or more container images**, tracking their versions (tags) over time.

Think of Image Streams as:

```
A smart reference to container images that can automatically trigger deployments when images change.
```

---

## ğŸ” Why Image Streams Exist

Traditional Kubernetes uses direct image references like:

```
docker.io/myrepo/frontend:v1
```

But OpenShift adds ImageStreams to provide:

| Capability               | Benefit                                        |
| ------------------------ | ---------------------------------------------- |
| Image version tracking   | Full history of image changes                  |
| Automation trigger       | Deploy automatically on new build/image        |
| Central registry pointer | Single source of truth for multiple registries |
| Integration with CI/CD   | Works with Builds and DeploymentConfigs        |

---

## ğŸ§© How Image Streams Work

An ImageStream contains:

* **Tags** (e.g., `latest`, `v1`, `prod`)
* **History** of image changes per tag
* **References to registries**

  * OpenShift Internal Registry
  * Docker Hub
  * Quay
  * ECR/GCR/ACR etc.

Example:

```
frontend:latest â†’ quay.io/sockshop/frontend@sha256:xxxx
```

---

## ğŸ” Triggers with Image Streams

When an ImageStream tag changes, it can trigger:

| Component        | Trigger                     |
| ---------------- | --------------------------- |
| DeploymentConfig | ImageChange Trigger         |
| BuildConfig      | New build (source-to-image) |
| Pipelines        | Job execution               |

This enables **end-to-end automation without modifying YAML**.

---

## ğŸ§± YAML â€” Basic ImageStream Example

```yaml
apiVersion: image.openshift.io/v1
kind: ImageStream
metadata:
  name: frontend
spec:
  tags:
  - name: latest
    from:
      kind: DockerImage
      name: quay.io/sockshop/frontend:latest
```

---

## ğŸ“Œ CLI Commands

### Create ImageStream

```bash
oc create is frontend
```

### List ImageStreams

```bash
oc get is
```

### Show ImageStream details

```bash
oc describe is frontend
```

### Tag an image into ImageStream

```bash
oc tag quay.io/sockshop/frontend:latest frontend:latest
```

### Check image history

```bash
oc get istag
```

---

## ğŸ§® How Image Streams Track Updates

| Without ImageStream                                           | With ImageStream                     |
| ------------------------------------------------------------- | ------------------------------------ |
| Direct image reference must be manually updated in Deployment | DeploymentConfig rolls automatically |
| No image history                                              | Full version history                 |
| No CI/CD triggers                                             | Auto triggers from build/push        |

---

## ğŸ”— Image Streams + Internal Registry

OpenShift internal registry exposes namespace-scoped repo:

```
image-registry.openshift-image-registry.svc:5000/<namespace>/<image>:<tag>
```

Push internal image:

```bash
docker push $(oc registry info)/sockshop/frontend:latest
```

IS updates â†’ triggers rollout (if configured in DC).

---

## ğŸš€ Real-world Use Case

### Build â†’ Push â†’ Auto Deploy

```
S2I Build finishes â†’ pushes to ImageStream (frontend:latest)
ImageStream tag updates â†’ DeploymentConfig auto-rolls
Updated Pod version goes live without YAML edit
```

This is why ImageStreams are heavily used in:

* Traditional OpenShift CI/CD
* Source-to-Image (S2I)
* Internal isolated container registries

---

## ğŸ“Œ Best Practices

| Recommendation                           | Reason                            |
| ---------------------------------------- | --------------------------------- |
| Use ImageStreams with DeploymentConfigs  | Enables image-change auto-rollout |
| Use Deployments with external registries | Simpler for GitOps/Helm           |
| Tag immutably (`v1`, `v2`, etc.)         | Avoids surprises during rollouts  |
| Avoid overwriting `latest` in production | Causes unplanned deployments      |

---

## ğŸ§  Summary

```
Kubernetes image   â†’ static reference
OpenShift ImageStream â†’ tracked, versioned, trigger-capable reference
```

ImageStreams = **Automation + Governance for container images**.

